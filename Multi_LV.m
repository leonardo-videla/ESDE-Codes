function [t, sol]=Multi_LV (x0, c, A, sigma, T, h)%Solves the multispecies stochastic Lotka-Volterra system of SDE through Milstein method.%(cfr. STOCHASTIC LOTKA-VOLTERRA FOOD CHAINS. Hening, Nguyen, J. Math. Biol.2018)%Parameters: %x0: n-component vector with the initial condition%c: n-components real vector autocorrelation coefficients. %A: $n \times n$ real matrix with the interspecies coefficients. %sigma: n-component vector with the amount of white noise for each species. %T: time horizon%h: stepsize for the discretization t=[0:h:floor(T/h)];N=size(t, 2);n=size(x0);sol=zeros(n,N);%Auxiliary definitionsH=sqrt(h)*diag(ones(1,n));s=diag(sigma);for i=1:n  sol(i, 1)=x0(i);endforfor j=2:N  wiener=H*randn(n, 1);  d=diag(sol(:, j-1));  %This line is Euler method.  sol(:,j)=sol(:, j-1) + h*d* (c+A*sol(:, j-1)) +d*s*wiener;     %and this line adds the Milstein correction.  sol(:, j)=sol(:, j) + (1/2)*d*s*s*(diag(wiener)*wiener-h*ones(n, 1));endforendfunction