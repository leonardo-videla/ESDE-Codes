function l=lambda(seq, X, step)   threshold=4;  if (step==-1 && length(seq)>1)    n=code(seq);    l=min (threshold,  0.01/(X(n)));  elseif (step==-1 && length(seq)==1)    l=0;  endif  m=1;  for k=1:length(seq)    if (seq(k)==step)      m=k;    endif  endfor  if (m==1 && step==0)      l=max(min(threshold, X(1)), 1);  endif  if (m==1 && step==1)    l=max(min (threshold, X(2)),1);  endif      if (m>1)    l=max(min(threshold, X(code(seq(1:m)))),1);  endifendfunction